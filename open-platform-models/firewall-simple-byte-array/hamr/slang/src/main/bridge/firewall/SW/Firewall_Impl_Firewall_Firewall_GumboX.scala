// #Sireum

package firewall.SW

import org.sireum._
import firewall._

// Do not edit this file as it will be overwritten if HAMR codegen is rerun
object Firewall_Impl_Firewall_Firewall_GumboX {
  /** IEP-Post: Initialize Entrypoint Post-Condition
    *
    * @param api_EthernetFramesRxOut outgoing event data port
    * @param api_EthernetFramesTxOut outgoing event data port
    */
  @strictpure def inititialize_IEP_Post (
      api_EthernetFramesRxOut: Option[SW.RawEthernetMessage],
      api_EthernetFramesTxOut: Option[SW.RawEthernetMessage]): B =
    (// D-Inv-Guard: Datatype invariants for the types associated with Firewall's state variables and outgoing ports
     SW.RawEthernetMessage.D_Inv_Guard_RawEthernetMessage(api_EthernetFramesRxOut) &
     SW.RawEthernetMessage.D_Inv_Guard_RawEthernetMessage(api_EthernetFramesTxOut))

  /** IEP-Post: Initialize Entrypoint Post-Condition via container
    *
    * @param post Container holding the value of incoming ports and the pre-state values of state variables
    */
  @strictpure def inititialize_IEP_Post_Container (post: Firewall_Impl_Firewall_Firewall_PostState_Container_PS): B =
    inititialize_IEP_Post (
      api_EthernetFramesRxOut = post.api_EthernetFramesRxOut,
      api_EthernetFramesTxOut = post.api_EthernetFramesTxOut)

  /** CEP-Pre: Compute Entrypoint Pre-Condition for Firewall
    *
    * @param api_EthernetFramesRxIn incoming event data port
    * @param api_EthernetFramesTxIn incoming event data port
    */
  @strictpure def compute_CEP_Pre (
      api_EthernetFramesRxIn: Option[SW.RawEthernetMessage],
      api_EthernetFramesTxIn: Option[SW.RawEthernetMessage]): B =
    (// D-Inv-Guard: Datatype invariants for the types associated with Firewall's state variables and incoming ports
     SW.RawEthernetMessage.D_Inv_Guard_RawEthernetMessage(api_EthernetFramesRxIn) & 
     SW.RawEthernetMessage.D_Inv_Guard_RawEthernetMessage(api_EthernetFramesTxIn))

  /** CEP-Pre: Compute Entrypoint Pre-Condition for Firewall via container
    *
    * @param pre Container holding the value of incoming ports and the pre-state values of state variables
    */
  @strictpure def compute_CEP_Pre_Container(pre: Firewall_Impl_Firewall_Firewall_PreState_Container_PS): B =
    compute_CEP_Pre(
      api_EthernetFramesRxIn = pre.api_EthernetFramesRxIn,
      api_EthernetFramesTxIn = pre.api_EthernetFramesTxIn)

  /** Compute Entrypoint Contract
    *
    * guarantee rx
    * @param api_EthernetFramesRxIn incoming event data port
    * @param api_EthernetFramesRxOut outgoing event data port
    */
  @strictpure def compute_spec_rx_guarantee(
      api_EthernetFramesRxIn: Option[SW.RawEthernetMessage],
      api_EthernetFramesRxOut: Option[SW.RawEthernetMessage]): B =
    (api_EthernetFramesRxIn.nonEmpty ___>:
       (api_EthernetFramesRxOut.nonEmpty ___>:
         Firewall_Impl_Firewall_Firewall.should_allow_inbound_frame_rx(api_EthernetFramesRxIn.get, T) &&
           api_EthernetFramesRxIn.get == api_EthernetFramesRxOut.get) &&
         (api_EthernetFramesRxOut.isEmpty __>: Firewall_Impl_Firewall_Firewall.should_allow_inbound_frame_rx(api_EthernetFramesRxIn.get, F))) &&
      (!(api_EthernetFramesRxIn.nonEmpty) __>: api_EthernetFramesRxOut.isEmpty)

  /** Compute Entrypoint Contract
    *
    * guarantee tx
    * @param api_EthernetFramesTxIn incoming event data port
    * @param api_EthernetFramesTxOut outgoing event data port
    */
  @strictpure def compute_spec_tx_guarantee(
      api_EthernetFramesTxIn: Option[SW.RawEthernetMessage],
      api_EthernetFramesTxOut: Option[SW.RawEthernetMessage]): B =
    (api_EthernetFramesTxIn.nonEmpty ___>:
       (api_EthernetFramesTxOut.nonEmpty ___>:
         Firewall_Impl_Firewall_Firewall.should_allow_outbound_frame_tx(api_EthernetFramesTxIn.get, T) &&
           api_EthernetFramesTxIn.get == api_EthernetFramesTxOut.get) &&
         (api_EthernetFramesTxOut.isEmpty __>: Firewall_Impl_Firewall_Firewall.should_allow_outbound_frame_tx(api_EthernetFramesTxIn.get, F))) &&
      (!(api_EthernetFramesTxIn.nonEmpty) __>: api_EthernetFramesTxOut.isEmpty)

  /** CEP-T-Guar: Top-level guarantee contracts for Firewall's compute entrypoint
    *
    * @param api_EthernetFramesRxIn incoming event data port
    * @param api_EthernetFramesTxIn incoming event data port
    * @param api_EthernetFramesRxOut outgoing event data port
    * @param api_EthernetFramesTxOut outgoing event data port
    */
  @strictpure def compute_CEP_T_Guar (
      api_EthernetFramesRxIn: Option[SW.RawEthernetMessage],
      api_EthernetFramesTxIn: Option[SW.RawEthernetMessage],
      api_EthernetFramesRxOut: Option[SW.RawEthernetMessage],
      api_EthernetFramesTxOut: Option[SW.RawEthernetMessage]): B =
    compute_spec_rx_guarantee(api_EthernetFramesRxIn, api_EthernetFramesRxOut) &
    compute_spec_tx_guarantee(api_EthernetFramesTxIn, api_EthernetFramesTxOut)

  /** CEP-Post: Compute Entrypoint Post-Condition for Firewall
    *
    * @param api_EthernetFramesRxIn incoming event data port
    * @param api_EthernetFramesTxIn incoming event data port
    * @param api_EthernetFramesRxOut outgoing event data port
    * @param api_EthernetFramesTxOut outgoing event data port
    */
  @strictpure def compute_CEP_Post (
      api_EthernetFramesRxIn: Option[SW.RawEthernetMessage],
      api_EthernetFramesTxIn: Option[SW.RawEthernetMessage],
      api_EthernetFramesRxOut: Option[SW.RawEthernetMessage],
      api_EthernetFramesTxOut: Option[SW.RawEthernetMessage]): B =
    (// D-Inv-Guard: Datatype invariants for the types associated with Firewall's state variables and outgoing ports
     SW.RawEthernetMessage.D_Inv_Guard_RawEthernetMessage(api_EthernetFramesRxIn) & 
     SW.RawEthernetMessage.D_Inv_Guard_RawEthernetMessage(api_EthernetFramesTxIn) & 
     SW.RawEthernetMessage.D_Inv_Guard_RawEthernetMessage(api_EthernetFramesRxOut) & 
     SW.RawEthernetMessage.D_Inv_Guard_RawEthernetMessage(api_EthernetFramesTxOut) & 

     // CEP-Guar: guarantee clauses of Firewall's compute entrypoint
     compute_CEP_T_Guar (api_EthernetFramesRxIn, api_EthernetFramesTxIn, api_EthernetFramesRxOut, api_EthernetFramesTxOut))

  /** CEP-Post: Compute Entrypoint Post-Condition for Firewall via containers
    *
    * @param pre Container holding the values of incoming ports and the pre-state values of state variables
    * @param post Container holding the values of outgoing ports and the post-state values of state variables
    */
  @strictpure def compute_CEP_Post_Container(
      pre: Firewall_Impl_Firewall_Firewall_PreState_Container_PS,
      post: Firewall_Impl_Firewall_Firewall_PostState_Container_PS): B =
    compute_CEP_Post(
      api_EthernetFramesRxIn = pre.api_EthernetFramesRxIn,
      api_EthernetFramesTxIn = pre.api_EthernetFramesTxIn,
      api_EthernetFramesRxOut = post.api_EthernetFramesRxOut,
      api_EthernetFramesTxOut = post.api_EthernetFramesTxOut)
}
